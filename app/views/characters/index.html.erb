<div class="container mt-4">
  <h1 class="mb-4 text-center">Hey Arnold! Characters</h1>

  <!-- Search and Filter Form -->
  <div class="mb-4">
    <%= form_with url: characters_path, method: :get, local: true, class: "row g-3 align-items-center justify-content-center" do |form| %>
      <div class="col-md-4">
        <%= form.text_field :search, value: params[:search], placeholder: "Search characters...", class: "form-control" %>
      </div>
      <div class="col-md-3">
        <%= form.select :location_id,
            options_from_collection_for_select(Location.all, :id, :name, params[:location_id]),
            { include_blank: "All Locations" },
            class: "form-select" %>
      </div>
      <div class="col-md-2">
        <%= form.submit "Search", class: "btn btn-primary w-100" %>
      </div>
    <% end %>
  </div>


<h1>Characters</h1>

<% if @characters.present? %>
  <% @characters.each do |c| %>
    <div class="card mb-3 p-3 d-flex flex-row align-items-center">
      <div style="margin-right: 20px;">
  <%
    # Determine the correct file path
    base_name = c.image_url.present? ? c.image_url.sub(/\.(png|jpg)$/, '') : "placeholder"
    # Try png first, then jpg, then placeholder
    image_path = if Rails.application.assets.find_asset("characters/#{base_name}.png")
                   "characters/#{base_name}.png"
                 elsif Rails.application.assets.find_asset("characters/#{base_name}.jpg")
                   "characters/#{base_name}.jpg"
                 else
                   "placeholder.png"
                 end
  %>
  <%= image_tag image_path, width: 100, alt: c.name.presence || "Unknown Character" %>
</div>

    </div>
  <% end %>
<% else %>
  <p>No characters found.</p>
<% end %>
